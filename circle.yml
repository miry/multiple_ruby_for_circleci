dependencies:
  cache_directories:
    - '/home/ubuntu/.rvm/rubies/ruby-head'

  pre:
    - rvm install ruby-head
    - rvm install jruby

  override:
    - rvm-exec 2.1.0 bash -c "bundle check --path=vendor/bundle || bundle install --path=vendor/bundle"
    - rvm-exec 2.2.0-preview1 bash -c "bundle check --path=vendor/bundle || bundle install --path=vendor/bundle"
    - rvm-exec ruby-head bash -c "bundle check --path=vendor/bundle || bundle install --path=vendor/bundle"
    - rvm-exec jruby bash -c "bundle check --path=vendor/bundle || bundle install --path=vendor/bundle"

test:
  override:
    - rvm-exec 2.1.0 bundle exec rake
    - rvm-exec 2.2.0-preview1 bundle exec rake
    - rvm-exec ruby-head bundle exec rake
    - rvm-exec jruby bundle exec rake
